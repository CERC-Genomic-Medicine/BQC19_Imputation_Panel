### Ancestry Estimation

In this pipeline we inferred the genetic ancestry of samples using the reference PCA space that we generated by HDGP+1KG dataset, and TRACE algorithm as well as random forest and k-nearest neighbour classifier. 

1- We generate the reference PCA space (K default = 20).
2- We project the study samples on reference PCA space to assess study PCs.
3- Using reference PCs and reference ancestry labels we train a random forest classification model as well as a k-nearest neighbour classification model.
4- We inferred the genetic ancestry labels of study samples using the trained classifier.

Our pipline outputs reference PCs, study PCs, study ancestry labels, 3D PCA plot(PC1, PC2, PC3) demonstrating projection of study samples on reference PCA space, as well as confusion matrix for each classifier.

In order to run the pipeline please use the following command:

  sbatch --account="name of the account" --time=48:00:00 --mem=4G -J coverage --wrap="nextflow run /path/to/ancestry.nf" -o ancestry.slurm.log
  